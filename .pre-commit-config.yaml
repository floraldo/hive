# Simple pre-commit configuration for Hive platform
# Focused on preventing syntax errors that plague AI agents

repos:
  # Ruff - Fast Python linter and formatter
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.13.2
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format

  # Black - Code formatter (backup to ruff)
  - repo: https://github.com/psf/black
    rev: 24.8.0
    hooks:
      - id: black
        language_version: python3.11

  # Basic Python syntax check
  - repo: local
    hooks:
      - id: python-syntax-check
        name: Check Python syntax
        entry: python -m py_compile
        language: system
        types: [python]
        pass_filenames: true

      # Golden Rules architectural validation
      - id: golden-rules-check
        name: Validate Golden Rules compliance
        entry: python scripts/validate_golden_rules.py --incremental
        language: system
        types: [python]
        pass_filenames: false
        verbose: true
        # ENABLED: Automatic validation on commit
        # Use SKIP=golden-rules-check git commit to bypass if needed

      # Autofix validation (async naming, code quality)
      - id: autofix-validation
        name: Autofix code quality checks
        entry: python -c "from hive_tests.autofix import AutoFix; import sys; af = AutoFix(); violations = []; [violations.extend(af._check_async_naming(f)) for f in sys.argv[1:] if f.endswith('.py')]; print(f'✅ No violations' if not violations else f'⚠️  {len(violations)} violations (warning only)'); exit(0)"
        language: system
        types: [python]
        pass_filenames: true
        verbose: true
        # Warning only initially - change exit(0) to exit(1) to enforce
